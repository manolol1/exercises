
import java.lang.InterruptedException;
import java.lang.reflect.Field;

import java.awt.Color;
import java.awt.event.WindowEvent;
import javax.swing.JFrame;


/***********************************************************************
 * Die Klasse PadUtil ergänzt das Pad-Modul (zum Teil unter Rückgriff
 * auf Java Reflection) nicht-invasiv um zusätzliche Hilfsmethoden.
 *  @author Michael Stumpfl
 *  @version 0.1
 ***********************************************************************/
public class PadUtil {
   public static JFrame getPadFrame(Pad window) {
      Field padFrameField = null;  /* Information about the ‘frame’ field of the ‘Pad’ class */
      JFrame padFrame = null;      /* Internal JFrame member of the ‘Pad’ class */

      /* ‘Field’ object for windowʼs ‘frame’ member: */
      try {
         padFrameField = Pad.class.getDeclaredField("frame");
         padFrameField.setAccessible(true);
      } catch (NoSuchFieldException e) {
         return null;
      }

      /* Retrieve the fieldʼs value: */
      try {
         padFrame = (JFrame)padFrameField.get(window);
      } catch (IllegalAccessException e) {
         return null;
      }

      return (padFrame);
   }

/***********************************************************************
 * Fügt in die Ereignis-Warteschlange des gegebenen Fensters ein
 * WINDOW_CLOSING Ereignis ein, wodurch sich dieses in weiterer Folge
 * schließen sollte.
 *  @param window   Referenz auf das zu schließende (Pad-)Fenster.
 *  @return   Flag, ob das Fenster geschlossen werden konnte.
 ***********************************************************************/
   public static boolean closeWindow(Pad window) {
      JFrame padFrame;

      if ((padFrame=getPadFrame(window)) == null)
        return false;

      padFrame.dispatchEvent(new WindowEvent(padFrame, WindowEvent.WINDOW_CLOSING));
      return true;
   }

/***********************************************************************
 * Hält die Programmausführung für ‘ms’ Millisekunden an. Anstelle
 * eines CPU-intensiven "busy waiting" wird die Aufgabe des eigentlichen
 * Wartens dabei an die statische Methode ‘sleep()’ der Thread-Klasse
 * übertragen. Im verwiesenen Blogbeitrag findet sich eine Erklärung,
 * weshalb Thread.currentThread().interrupt(); in der Regel eine gute
 * Idee ist.
 *  @param ms   Anzahl der zu wartenden Millisekunden.
 *  @see <a href="https://www.javaspecialists.eu/archive/Issue056-Shutting-down-Threads-Cleanly.html">Shutting down Threads Cleanly</a>
 ***********************************************************************/
   public static void sleep (int ms)
   {
      try {
         Thread.sleep(ms);
      }
      catch (InterruptedException e) {
         Thread.currentThread().interrupt();
      }
   }

/***********************************************************************
 * VGA (“Video Graphics Array”) 256 default color palette.
 *  @param index   Index der gewünschten Farbe.
 *  @return   liefert (index % 256)-te Farbe der VGA Farbpalette.
 ***********************************************************************/
   public static Color vgaColor (int index) {
      index %= vgaColorPalette.length;
      return (vgaColorPalette[index]);
   }

   private static Color[] vgaColorPalette = {
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x02, 0xaa),
         new Color (0x14, 0xaa, 0x00),
         new Color (0x00, 0xaa, 0xaa),
         new Color (0xaa, 0x00, 0x03),
         new Color (0xaa, 0x00, 0xaa),
         new Color (0xaa, 0x55, 0x00),
         new Color (0xaa, 0xaa, 0xaa),
         new Color (0x55, 0x55, 0x55),
         new Color (0x55, 0x55, 0xff),
         new Color (0x55, 0xff, 0x55),
         new Color (0x55, 0xff, 0xff),
         new Color (0xff, 0x55, 0x55),
         new Color (0xfd, 0x55, 0xff),
         new Color (0xff, 0xff, 0x55),
         new Color (0xff, 0xff, 0xff),
         new Color (0x00, 0x00, 0x00),
         new Color (0x10, 0x10, 0x10),
         new Color (0x20, 0x20, 0x20),
         new Color (0x35, 0x35, 0x35),
         new Color (0x45, 0x45, 0x45),
         new Color (0x55, 0x55, 0x55),
         new Color (0x65, 0x65, 0x65),
         new Color (0x75, 0x75, 0x75),
         new Color (0x8a, 0x8a, 0x8a),
         new Color (0x9a, 0x9a, 0x9a),
         new Color (0xaa, 0xaa, 0xaa),
         new Color (0xba, 0xba, 0xba),
         new Color (0xca, 0xca, 0xca),
         new Color (0xdf, 0xdf, 0xdf),
         new Color (0xef, 0xef, 0xef),
         new Color (0xff, 0xff, 0xff),
         new Color (0x00, 0x04, 0xff),
         new Color (0x41, 0x04, 0xff),
         new Color (0x82, 0x03, 0xff),
         new Color (0xbe, 0x02, 0xff),
         new Color (0xfd, 0x00, 0xff),
         new Color (0xfe, 0x00, 0xbe),
         new Color (0xff, 0x00, 0x82),
         new Color (0xff, 0x00, 0x41),
         new Color (0xff, 0x00, 0x08),
         new Color (0xff, 0x41, 0x05),
         new Color (0xff, 0x82, 0x00),
         new Color (0xff, 0xbe, 0x00),
         new Color (0xff, 0xff, 0x00),
         new Color (0xbe, 0xff, 0x00),
         new Color (0x82, 0xff, 0x00),
         new Color (0x41, 0xff, 0x01),
         new Color (0x24, 0xff, 0x00),
         new Color (0x22, 0xff, 0x42),
         new Color (0x1d, 0xff, 0x82),
         new Color (0x12, 0xff, 0xbe),
         new Color (0x00, 0xff, 0xff),
         new Color (0x00, 0xbe, 0xff),
         new Color (0x01, 0x82, 0xff),
         new Color (0x00, 0x41, 0xff),
         new Color (0x82, 0x82, 0xff),
         new Color (0x9e, 0x82, 0xff),
         new Color (0xbe, 0x82, 0xff),
         new Color (0xdf, 0x82, 0xff),
         new Color (0xfd, 0x82, 0xff),
         new Color (0xfe, 0x82, 0xdf),
         new Color (0xff, 0x82, 0xbe),
         new Color (0xff, 0x82, 0x9e),
         new Color (0xff, 0x82, 0x82),
         new Color (0xff, 0x9e, 0x82),
         new Color (0xff, 0xbe, 0x82),
         new Color (0xff, 0xdf, 0x82),
         new Color (0xff, 0xff, 0x82),
         new Color (0xdf, 0xff, 0x82),
         new Color (0xbe, 0xff, 0x82),
         new Color (0x9e, 0xff, 0x82),
         new Color (0x82, 0xff, 0x82),
         new Color (0x82, 0xff, 0x9e),
         new Color (0x82, 0xff, 0xbe),
         new Color (0x82, 0xff, 0xdf),
         new Color (0x82, 0xff, 0xff),
         new Color (0x82, 0xdf, 0xff),
         new Color (0x82, 0xbe, 0xff),
         new Color (0x82, 0x9e, 0xff),
         new Color (0xba, 0xba, 0xff),
         new Color (0xca, 0xba, 0xff),
         new Color (0xdf, 0xba, 0xff),
         new Color (0xef, 0xba, 0xff),
         new Color (0xfe, 0xba, 0xff),
         new Color (0xfe, 0xba, 0xef),
         new Color (0xff, 0xba, 0xdf),
         new Color (0xff, 0xba, 0xca),
         new Color (0xff, 0xba, 0xba),
         new Color (0xff, 0xca, 0xba),
         new Color (0xff, 0xdf, 0xba),
         new Color (0xff, 0xef, 0xba),
         new Color (0xff, 0xff, 0xba),
         new Color (0xef, 0xff, 0xba),
         new Color (0xdf, 0xff, 0xba),
         new Color (0xca, 0xff, 0xbb),
         new Color (0xba, 0xff, 0xba),
         new Color (0xba, 0xff, 0xca),
         new Color (0xba, 0xff, 0xdf),
         new Color (0xba, 0xff, 0xef),
         new Color (0xba, 0xff, 0xff),
         new Color (0xba, 0xef, 0xff),
         new Color (0xba, 0xdf, 0xff),
         new Color (0xba, 0xca, 0xff),
         new Color (0x01, 0x01, 0x71),
         new Color (0x1c, 0x01, 0x71),
         new Color (0x39, 0x01, 0x71),
         new Color (0x55, 0x00, 0x71),
         new Color (0x71, 0x00, 0x71),
         new Color (0x71, 0x00, 0x55),
         new Color (0x71, 0x00, 0x39),
         new Color (0x71, 0x00, 0x1c),
         new Color (0x71, 0x00, 0x01),
         new Color (0x71, 0x1c, 0x01),
         new Color (0x71, 0x39, 0x00),
         new Color (0x71, 0x55, 0x00),
         new Color (0x71, 0x71, 0x00),
         new Color (0x55, 0x71, 0x00),
         new Color (0x39, 0x71, 0x00),
         new Color (0x1c, 0x71, 0x00),
         new Color (0x09, 0x71, 0x00),
         new Color (0x09, 0x71, 0x1c),
         new Color (0x06, 0x71, 0x39),
         new Color (0x03, 0x71, 0x55),
         new Color (0x00, 0x71, 0x71),
         new Color (0x00, 0x55, 0x71),
         new Color (0x00, 0x39, 0x71),
         new Color (0x00, 0x1c, 0x71),
         new Color (0x39, 0x39, 0x71),
         new Color (0x45, 0x39, 0x71),
         new Color (0x55, 0x39, 0x71),
         new Color (0x61, 0x39, 0x71),
         new Color (0x71, 0x39, 0x71),
         new Color (0x71, 0x39, 0x61),
         new Color (0x71, 0x39, 0x55),
         new Color (0x71, 0x39, 0x45),
         new Color (0x71, 0x39, 0x39),
         new Color (0x71, 0x45, 0x39),
         new Color (0x71, 0x55, 0x39),
         new Color (0x71, 0x61, 0x39),
         new Color (0x71, 0x71, 0x39),
         new Color (0x61, 0x71, 0x39),
         new Color (0x55, 0x71, 0x39),
         new Color (0x45, 0x71, 0x3a),
         new Color (0x39, 0x71, 0x39),
         new Color (0x39, 0x71, 0x45),
         new Color (0x39, 0x71, 0x55),
         new Color (0x39, 0x71, 0x61),
         new Color (0x39, 0x71, 0x71),
         new Color (0x39, 0x61, 0x71),
         new Color (0x39, 0x55, 0x71),
         new Color (0x39, 0x45, 0x72),
         new Color (0x51, 0x51, 0x71),
         new Color (0x59, 0x51, 0x71),
         new Color (0x61, 0x51, 0x71),
         new Color (0x69, 0x51, 0x71),
         new Color (0x71, 0x51, 0x71),
         new Color (0x71, 0x51, 0x69),
         new Color (0x71, 0x51, 0x61),
         new Color (0x71, 0x51, 0x59),
         new Color (0x71, 0x51, 0x51),
         new Color (0x71, 0x59, 0x51),
         new Color (0x71, 0x61, 0x51),
         new Color (0x71, 0x69, 0x51),
         new Color (0x71, 0x71, 0x51),
         new Color (0x69, 0x71, 0x51),
         new Color (0x61, 0x71, 0x51),
         new Color (0x59, 0x71, 0x51),
         new Color (0x51, 0x71, 0x51),
         new Color (0x51, 0x71, 0x5a),
         new Color (0x51, 0x71, 0x61),
         new Color (0x51, 0x71, 0x69),
         new Color (0x51, 0x71, 0x71),
         new Color (0x51, 0x69, 0x71),
         new Color (0x51, 0x61, 0x71),
         new Color (0x51, 0x59, 0x71),
         new Color (0x00, 0x00, 0x42),
         new Color (0x11, 0x00, 0x41),
         new Color (0x20, 0x00, 0x41),
         new Color (0x31, 0x00, 0x41),
         new Color (0x41, 0x00, 0x41),
         new Color (0x41, 0x00, 0x32),
         new Color (0x41, 0x00, 0x20),
         new Color (0x41, 0x00, 0x10),
         new Color (0x41, 0x00, 0x00),
         new Color (0x41, 0x10, 0x00),
         new Color (0x41, 0x20, 0x00),
         new Color (0x41, 0x31, 0x00),
         new Color (0x41, 0x41, 0x00),
         new Color (0x31, 0x41, 0x00),
         new Color (0x20, 0x41, 0x00),
         new Color (0x10, 0x41, 0x00),
         new Color (0x03, 0x41, 0x00),
         new Color (0x03, 0x41, 0x10),
         new Color (0x02, 0x41, 0x20),
         new Color (0x01, 0x41, 0x31),
         new Color (0x00, 0x41, 0x41),
         new Color (0x00, 0x31, 0x41),
         new Color (0x00, 0x20, 0x41),
         new Color (0x00, 0x10, 0x41),
         new Color (0x20, 0x20, 0x41),
         new Color (0x28, 0x20, 0x41),
         new Color (0x31, 0x20, 0x41),
         new Color (0x39, 0x20, 0x41),
         new Color (0x41, 0x20, 0x41),
         new Color (0x41, 0x20, 0x39),
         new Color (0x41, 0x20, 0x31),
         new Color (0x41, 0x20, 0x28),
         new Color (0x41, 0x20, 0x20),
         new Color (0x41, 0x28, 0x20),
         new Color (0x41, 0x31, 0x20),
         new Color (0x41, 0x39, 0x21),
         new Color (0x41, 0x41, 0x20),
         new Color (0x39, 0x41, 0x20),
         new Color (0x31, 0x41, 0x20),
         new Color (0x28, 0x41, 0x20),
         new Color (0x20, 0x41, 0x20),
         new Color (0x20, 0x41, 0x28),
         new Color (0x20, 0x41, 0x31),
         new Color (0x20, 0x41, 0x39),
         new Color (0x20, 0x41, 0x41),
         new Color (0x20, 0x39, 0x41),
         new Color (0x20, 0x31, 0x41),
         new Color (0x20, 0x28, 0x41),
         new Color (0x2d, 0x2d, 0x41),
         new Color (0x31, 0x2d, 0x41),
         new Color (0x35, 0x2d, 0x41),
         new Color (0x3d, 0x2d, 0x41),
         new Color (0x41, 0x2d, 0x41),
         new Color (0x41, 0x2d, 0x3d),
         new Color (0x41, 0x2d, 0x35),
         new Color (0x41, 0x2d, 0x31),
         new Color (0x41, 0x2d, 0x2d),
         new Color (0x41, 0x31, 0x2d),
         new Color (0x41, 0x35, 0x2d),
         new Color (0x41, 0x3d, 0x2d),
         new Color (0x41, 0x41, 0x2d),
         new Color (0x3d, 0x41, 0x2d),
         new Color (0x35, 0x41, 0x2d),
         new Color (0x31, 0x41, 0x2d),
         new Color (0x2d, 0x41, 0x2d),
         new Color (0x2d, 0x41, 0x31),
         new Color (0x2d, 0x41, 0x35),
         new Color (0x2d, 0x41, 0x3d),
         new Color (0x2d, 0x41, 0x41),
         new Color (0x2d, 0x3d, 0x41),
         new Color (0x2d, 0x35, 0x41),
         new Color (0x2d, 0x31, 0x41),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00),
         new Color (0x00, 0x00, 0x00)
      };
};
